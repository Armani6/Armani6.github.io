<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="Armani">
    
    
    
    
    
    
    <title>Java高级篇（一）——线程 | 喵绪~~</title>
    <link href="”https://z.zhsh666.xyz“" rel="”prefetch”">

    <link rel="stylesheet" href="/css/bootstrap.min.css">
<link rel="stylesheet" href="/css/aos.css">
<link rel="stylesheet" href="/css/style.css">
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/aos.js"></script>
    <script src="/js/highslide/highslide-full.min.js"></script>
    <link rel="stylesheet" href="/js/highslide/highslide.css">
    <style type="text/css">
        @media (max-width: 768px) {
            body {
                background-color: #f0f0f0;
                background: url('/imgs/xsbg.gif');
                background-attachment: fixed;
            }
        }
    </style>
    
    <script src="//cdn1.lncld.net/static/js/3.4.2/av-min.js"></script>
    <script>
      AV.init({
        appId: '73Abvm6XRQ0U1tBrHieC2tYJ-9Nh9j0Va',
        appKey: 'FUCDJNElBOM5yMjIPNSFEy8z'
      })
    </script>
    
    <!--<script type="text/javascript">
      if (document.images) {
        var avatar = new Image();
        avatar.src = '/imgs/avatar.jpg'
        var previews = 'preview1.jpg,preview2.jpg,preview3.jpg,preview4.jpg,preview5.jpg,preview6.jpg,preview7.jpg,preview8.jpg'.split(',')
        var previewsPreLoad = []
        for(var i = 0; i < length; i++) {
          previewsPreLoad.push(new Image())
          previewsPreLoad[previewsPreLoad.length - 1].src = '/imgs/preview' + previews[i]
        }
      }
    </script>-->
</head>
<script src="https://cdn1.lncld.net/static/js/av-min-1.2.1.js"></script>
  <script>AV.initialize("73Abvm6XRQ0U1tBrHieC2tYJ-9Nh9j0Va ", "FUCDJNElBOM5yMjIPNSFEy8z");</script></html>
<body>
    <!-- 背景轮播图功能 -->
    <section class="hidden-xs">
    <ul class="cb-slideshow">
        <li><span>天若</span></li>
        <li><span>有情</span></li>
        <li><span>天亦老</span></li>
        <li><span>我为</span></li>
        <li><span>长者</span></li>
        <li><span>续一秒</span></li>
    </ul>
</section>
    <!-- 欧尼酱功能, 谁用谁知道 -->
    
    <div class="gal-menu gal-dropdown">
    <div class="circle" id="gal">
        <div class="ring">
            <a href="https://z.zhsh666.xyz" class="menuItem" style="left: 50%; top: 15%;">首页</a>
            
            <a class="menuItem" style="left: 80.3109%; top: 32.5%;">下一页</a>
            
            <a href="/archives" class="menuItem" style="left: 80.3109%; top: 67.5%;">归档</a>
            <a href="/about" class="menuItem" style="left: 50%; top: 85%;">关于</a>
            <a href="/message" class="menuItem" style="left: 19.6891%; top: 67.5%;">留言板</a>
            
            <a class="menuItem" style="left: 19.6891%; top: 32.5%;">上一页</a>
            
        </div>
        <audio id="audio" src="/imgs/oni.mp3"></audio>
    </div>
</div>
    
    <header class="navbar navbar-inverse" id="gal-header">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed"
                    data-toggle="collapse" data-target=".bs-navbar-collapse"
                    aria-expanded="false">
                <span class="fa fa-lg fa-reorder"></span>
            </button>
            <a href="https://z.zhsh666.xyz">
                
                <style>
                    #gal-header .navbar-brand {
                        height: 54px;
                        line-height: 24px;
                        font-size: 28px;
                        opacity: 1;
                        background-color: rgba(0,0,0,0);
                        text-shadow: 0 0 5px #fff,0 0 10px #fff,0 0 15px #fff,0 0 20px #228DFF,0 0 35px #228DFF,0 0 40px #228DFF,0 0 50px #228DFF,0 0 75px #228DFF;
                    }
                </style>
                <!-- 这里使用文字(navbar_text or config.title) -->
                <div class="navbar-brand">喵绪~</div>
                
            </a>
        </div>
        <div class="collapse navbar-collapse bs-navbar-collapse">
            <ul class="nav navbar-nav" id="menu-gal">
                
                
                <li class="">
                    <a href="/">
                        <i class="fa fa-home"></i>首页
                    </a>
                </li>
                
                
                
                <li class="">
                    <a href="/archives">
                        <i class="fa fa-archive"></i>归档
                    </a>
                </li>
                
                
                
                <li class="">
                    <a href="/categories">
                        <i class="fa fa-list"></i>分类
                    </a>
                </li>
                
                
                
                
                <li class="dropdown">
                    <!-- TODO 添加hover dropdown效果 -->
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false" data-hover="dropdown">
                        <i class="fa fa-tags"></i>标签
                    </a>
                    <ul class="dropdown-menu">
                        
                        
                        <li>
                            <a href="/tags/hexo/">hexo</a>
                        </li>
                        
                        <li>
                            <a href="/tags/3-hexo/">3-hexo</a>
                        </li>
                        
                        <li>
                            <a href="/tags/Apache/">Apache</a>
                        </li>
                        
                        <li>
                            <a href="/tags/Tomcat/">Tomcat</a>
                        </li>
                        
                        <li>
                            <a href="/tags/服务器/">服务器</a>
                        </li>
                        
                        <li>
                            <a href="/tags/css/">css</a>
                        </li>
                        
                        
                        <li>
                            <a href="/tags">...</a>
                        </li>
                        
                        
                    </ul>
                </li>
                
                
                
                
                <li class="">
                    <a href="/about">
                        <i class="fa fa-user"></i>关于我
                    </a>
                </li>
                
                
            </ul>
        </div>
    </div>
</header>
    <div id="gal-body">
        <div class="container">
            <div class="row">
                <div class="col-md-8 gal-right" id="mainstay">
                    
<article class="article well article-body" id="article">
    <div class="breadcrumb">
        <i class="fa fa-home"></i>
        <a href="https://z.zhsh666.xyz">喵绪~~</a>
        >
        <span>Java高级篇（一）——线程</span>
    </div>
    <!-- 大型设备详细文章 -->
    <div class="hidden-xs">
        <div class="title-article">
            <h1>
                <a href="/2019/08/15/Java高级篇（一）——线程/">Java高级篇（一）——线程</a>
            </h1>
        </div>
        <div class="tag-article">
            
            <span class="label label-gal">
                <i class="fa fa-tags"></i>
                
                <a href="/tags/Java/">Java</a>, 
                
                <a href="/tags/java/">java</a>
                
            </span>
            
            <span class="label label-gal">
                <i class="fa fa-calendar"></i> 2019-08-15
            </span>
            
            <span class="label label-gal">
                <i class="fa fa-eye"></i>
            </span>
            
        </div>
    </div>
    <!-- 小型设备详细文章 -->
    <div class="visible-xs">
        <center>
            <div class="title-article">
                <h4>
                    <a href="/2019/08/15/Java高级篇（一）——线程/">Java高级篇（一）——线程</a>
                </h4>
            </div>
            <p>
                <i class="fa fa-calendar"></i> 2019-08-15
            </p>
            <p>
                
                <i class="fa fa-tags"></i>
                
                <a href="/tags/Java/">Java</a>, 
                
                <a href="/tags/java/">java</a>
                
                
                
                <i class="fa fa-eye"></i>
                
            </p>
        </center>
    </div>
    <div class="content-article">
        <p>前面我们系统的了解了Java的基础知识，本篇开始将进入到Java更深层次的介绍，我们先来介绍一下Java中的一个重要的概念——线程。</p>
<h2 id="一、什么是线程"><a href="#一、什么是线程" class="headerlink" title="一、什么是线程"></a>一、什么是线程</h2><p>　　在了解线程前，我们首先要了解进程的概念。进程是操作系统调度和分配资源的基本单位，进程之间的通信需要通过专门的系统机制，比如消息、socket和管道来完成。而线程是比进程更小的执行单位，每个线程拥有自己的栈和寄存器等资源数据，多个线程之间共享进程的代码、数据和文件。</p>
<p>　　那为什么要引入线程的概念？或者说线程有什么优点？</p>
<p>　　举个简单的例子，我们在使用电脑时，可以使用它听歌，可以使用它打印文件，也可以使用它看电影，而这些活动完全可以同时进行，这种思想在Java中被称为并发，线程就是并发完成的每一件事情。</p>
<p>　　线程的优点有如下几条：</p>
<ol>
<li>创建一个线程比创建一个进程的代价要小</li>
<li>线程的切换比进程间的切换代价小</li>
<li>充分利用多处理器</li>
<li>数据共享（数据共享使得线程之间的通信比进程间的通信更高效）</li>
<li>快速响应特性（在系统繁忙的情况下，进程通过独立的线程及时响应用户的输入 ）</li>
</ol>
<p>　　在单线程中，程序代码按调用顺序依次往下执行，如果需要一个进程同时完成多段代码的操作，就需要产生多线程。</p>
<h2 id="二、线程的实现"><a href="#二、线程的实现" class="headerlink" title="二、线程的实现"></a>二、线程的实现</h2><p>　　在Java中主要提供了两种方式实现线程，下面分别介绍一下这两种方式。</p>
<h3 id="1-继承Thread类"><a href="#1-继承Thread类" class="headerlink" title="　　1. 继承Thread类"></a>　　1. 继承Thread类</h3><p>　　在Java中可通过继承java.lang.Thread类来实现线程，语法格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public class MyThread extends Thread &#123;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>　　而完成线程真正功能的代码在run()方法中，且run()方法的语法格式固定，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public void run() &#123;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>　　之后通过调用start()方法启动线程，如果start()方法调用一个已经启动的线程，会抛出IllegalThreadStateException异常。</p>
<p>　　下面看一个实例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> 1 public class MyThread extends Thread &#123;</span><br><span class="line"> 2 </span><br><span class="line"> 3     private static int i=0;</span><br><span class="line"> 4     </span><br><span class="line"> 5     public void run() &#123;</span><br><span class="line"> 6         i++;    </span><br><span class="line"> 7         System.out.println(i);    </span><br><span class="line"> 8     &#125;</span><br><span class="line"> 9     </span><br><span class="line">10     public static void main(String[] args) &#123;</span><br><span class="line">11         MyThread myThread1 = new MyThread();</span><br><span class="line">12         MyThread myThread2 = new MyThread();</span><br><span class="line">13         MyThread myThread3 = new MyThread();</span><br><span class="line">14         myThread1.start();</span><br><span class="line">15         myThread2.start();</span><br><span class="line">16         myThread3.start();</span><br><span class="line">17     &#125;</span><br><span class="line">18 &#125;</span><br></pre></td></tr></table></figure>

<p>　　这里定义了三个线程，分别执行start()方法，运行结果如下：</p>
<p>　　<img src="https://images2018.cnblogs.com/blog/1018770/201803/1018770-20180326211918465-1592834983.png" alt="img"></p>
<p>　　如果不调用start()方法，线程永远都不会启动，在主方法没有调用start()方法之前，Thread对象只是一个实例，而不是一个真正的线程。</p>
<h3 id="2-实现Runnable接口"><a href="#2-实现Runnable接口" class="headerlink" title="　　2. 实现Runnable接口"></a>　　2. 实现Runnable接口</h3><p>　　我们知道每次只能继承一个类，如果此时要在使用线程的前提下还要继承其他类，就需要使用Runnable接口了。语法格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public class MyThread implements Runnable &#123;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>　　如果还要继承其他类，语法格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public class MyThread extends Object implements Runnable &#123;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>　　实现Runnable接口的程序会创建一个Thread对象，并将Runnable对象与Thread对象相关联。例如如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">new Thread(new Runnable()&#123;</span><br><span class="line"></span><br><span class="line">　　@Override</span><br><span class="line">　　public void run() &#123;</span><br><span class="line">　　　　i++;    </span><br><span class="line">　　　　System.out.println(i);    </span><br><span class="line">　　&#125;</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure>

<p>　　在Thread对象中实现Runnable接口，并将其start()。</p>
<h2 id="三、生命周期"><a href="#三、生命周期" class="headerlink" title="三、生命周期"></a>三、生命周期</h2><p>　　线程的生命周期包含出生状态、就绪状态、运行状态、等待状态、休眠状态、阻塞状态和死亡状态7种状态。当用户创建线程时线程处于出生状态；在用户调用start()方法后线程处于就绪状态；当线程得到资源后进入运行状态；当在运行态调用wait()方法时线程处于等待状态，此时必须调用notify()方法才能被唤醒，notifyAll()可以唤醒所有处于等待状态下的线程；当线程调用sleep()方法时会进入休眠状态；如果一个线程在运行状态下发出输入/输出请求，该线程将进入阻塞状态，在其等待输入/输出结束时线程进入就绪状态；当线程的run()方法执行完毕时线程进入死亡状态。（具体内容可参考操作系统）</p>
<p>　　下图为线程生命周期状态图，可对照上述文字加以理解。</p>
<p>　　<img src="/photo/index/1018770-20180326213758422-1099741618%5B0%5D.png" alt></p>
<h2 id="四、线程的休眠-加入-中断-礼让"><a href="#四、线程的休眠-加入-中断-礼让" class="headerlink" title="四、线程的休眠/加入/中断/礼让"></a>四、线程的休眠/加入/中断/礼让</h2><h3 id="1-线程的休眠-sleep"><a href="#1-线程的休眠-sleep" class="headerlink" title="　　1. 线程的休眠(sleep)"></a>　　1. 线程的休眠(sleep)</h3><p>　　调用sleep()方法，该方法需要一个参数用于指定线程休眠时间，单位为ms，通常用在run()方法内的循环中被使用，注意要使用try···catch包围。语法格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    Thread.sleep(1000);</span><br><span class="line">&#125; catch(InterruptedException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>　　使用了sleep()方法的线程在一段时间内会醒来，但是并不能保证它醒来后进入运行状态，只能保证它进入就绪状态。</p>
<h3 id="2-线程的加入-join"><a href="#2-线程的加入-join" class="headerlink" title="　　2. 线程的加入(join)"></a>　　2. 线程的加入(join)</h3><p>　　假设有一个线程A，现在需要插入线程B，并要求线程B先执行完毕，然后再继续执行线程A，此时可以使用join()方法来完成。当某个线程使用join()方法加入到另一个线程时，另一个线程会等待该线程执行完毕再继续执行。语法格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Thread.join();</span><br></pre></td></tr></table></figure>

<h3 id="3-线程的中断-stop-interrupt"><a href="#3-线程的中断-stop-interrupt" class="headerlink" title="　　3. 线程的中断(stop/interrupt)"></a>　　3. 线程的中断(stop/interrupt)</h3><p>　　stop()方法可以停止线程，但JDK早已废除，同时也不建议使用stop()方法来停止一个线程的运行。可在run()方法中使用无限循环的形式，然后使用一个布尔型标记控制循环的停止。如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> 1 public class InterruptedTest implements Runnable &#123;</span><br><span class="line"> 2 </span><br><span class="line"> 3     private boolean isContinue = false;        //标记变量，默认值为false</span><br><span class="line"> 4     </span><br><span class="line"> 5     @Override</span><br><span class="line"> 6     public void run() &#123;</span><br><span class="line"> 7         while(true) &#123;</span><br><span class="line"> 8             //... 此部分代码省略</span><br><span class="line"> 9             if(isContinue) &#123;        //为true时，停止线程</span><br><span class="line">10                 break;</span><br><span class="line">11             &#125;</span><br><span class="line">12         &#125;</span><br><span class="line">13     &#125;</span><br><span class="line">14     </span><br><span class="line">15 &#125;</span><br></pre></td></tr></table></figure>

<p>　　如果线程因为使用了sleep()或wait()方法进入了就绪状态，这时可以使用Thread类中的interrupt()方法使线程离开run()方法，同时结束线程，但会抛出InterruptedException异常。语法格式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Thread.interrupt();</span><br></pre></td></tr></table></figure>

<h3 id="4-程序的礼让-yield"><a href="#4-程序的礼让-yield" class="headerlink" title="　　4. 程序的礼让(yield)"></a>　　4. 程序的礼让(yield)</h3><p>　　Thread类中提供了一种礼让方法yield()，用于给当前正处于运行状态下的线程一个提醒，告知它可以将资源礼让给其他线程。</p>
<p>　　yield()方法使具有同样优先级的线程有进入可执行状态的机会，当当前线程放弃执行权时会再度回到就绪状态。</p>
<h2 id="五、线程同步"><a href="#五、线程同步" class="headerlink" title="五、线程同步"></a>五、线程同步</h2><p>　　多线程中，可能会发生两个线程抢占资源的问题，例如两个人同时过一个独木桥。所以Java提供线程同步机制来防止这些资源访问的冲突。</p>
<h3 id="1-线程同步机制"><a href="#1-线程同步机制" class="headerlink" title="　　1. 线程同步机制"></a>　　1. 线程同步机制</h3><p>　　在多线程中，多个线程共享同一个资源可能会出现一些问题，比如下面这个例子，火车售票系统。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"> 1 public class ThreadSafeTest implements Runnable &#123;</span><br><span class="line"> 2 </span><br><span class="line"> 3     int num = 10;</span><br><span class="line"> 4     </span><br><span class="line"> 5     @Override</span><br><span class="line"> 6     public void run() &#123;</span><br><span class="line"> 7         while(true) &#123;</span><br><span class="line"> 8             if(num&gt;0) &#123;</span><br><span class="line"> 9                 try &#123;</span><br><span class="line">10                     Thread.sleep(100);</span><br><span class="line">11                 &#125; catch (Exception e) &#123;</span><br><span class="line">12                     e.printStackTrace();</span><br><span class="line">13                 &#125;</span><br><span class="line">14                 System.out.println(&quot;车票剩余：&quot; + num-- + &quot;张&quot;);</span><br><span class="line">15             &#125;</span><br><span class="line">16         &#125;</span><br><span class="line">17     &#125;</span><br><span class="line">18 </span><br><span class="line">19     public static void main(String[] args) &#123;</span><br><span class="line">20         ThreadSafeTest test = new ThreadSafeTest();</span><br><span class="line">21         Thread tA = new Thread(test);        //实例化4个线程</span><br><span class="line">22         Thread tB = new Thread(test);</span><br><span class="line">23         Thread tC = new Thread(test);</span><br><span class="line">24         Thread tD = new Thread(test);</span><br><span class="line">25         tA.start();        //启动线程</span><br><span class="line">26         tB.start();</span><br><span class="line">27         tC.start();</span><br><span class="line">28         tD.start();</span><br><span class="line">29     &#125;</span><br><span class="line">30     </span><br><span class="line">31 &#125;</span><br></pre></td></tr></table></figure>

<p>　　运行结果如下：</p>
<p>　　<img src="/photo/index/1018770-20180326224559584-1275137303.png" alt></p>
<p>　　这里出现了剩余-1张的情况，究其原因是因为同时创建了4个线程，都执行run()方法时，四个线程对num都有储存功能，当线程1执行run()方法时，还没来得及递减，此时线程2、3、4都进入了run()方法，发现num仍大于0，但此时线程1休眠时间已到，将num变量递减，同时线程2、3、4也对num变量进行递减操作，从而产生了负值。同理出现多次十张的情况也是互相抢占了资源。换句话说就是产生了资源冲突问题，为了解决这种问题，就需要给共享资源上一道锁。最简单的例子就是上洗手间，一个人进去后要将门锁上，当他出来时再将锁打开，然后其他人才可以进。</p>
<p>　　我们使用同步块或同步方法来实现加锁操作。语法结构分别如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">synchronzied(Object) &#123;</span><br><span class="line">    //... </span><br><span class="line">&#125;</span><br><span class="line">synchronzied void test() &#123;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>　　可将上述代码改为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public class ThreadSafeTest implements Runnable &#123;</span><br><span class="line"></span><br><span class="line">    int num = 10;</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        while(true) &#123;</span><br><span class="line">            synchronized (&quot;&quot;) &#123;        //加锁        </span><br><span class="line">                if(num&gt;0) &#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        Thread.sleep(100);</span><br><span class="line">                    &#125; catch (Exception e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(&quot;车票剩余：&quot; + num-- + &quot;张&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ThreadSafeTest test = new ThreadSafeTest();</span><br><span class="line">        Thread tA = new Thread(test);        //实例化4个线程</span><br><span class="line">        Thread tB = new Thread(test);</span><br><span class="line">        Thread tC = new Thread(test);</span><br><span class="line">        Thread tD = new Thread(test);</span><br><span class="line">        tA.start();        //启动线程</span><br><span class="line">        tB.start();</span><br><span class="line">        tC.start();</span><br><span class="line">        tD.start();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>　　也可以用同步方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public synchronized void doit() &#123;        //定义同步方法</span><br><span class="line">    if(num&gt;0) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Thread.sleep(100);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    System.out.println(&quot;车票剩余：&quot; + num-- + &quot;张&quot;);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>　　两种方法运行结果一致，运行结果如下：</p>
<p><img src="/photo/index/1018770-20180326225706000-1175038514.png" alt></p>
<h2 id="六、线程实例测试"><a href="#六、线程实例测试" class="headerlink" title="六、线程实例测试"></a>六、线程实例测试</h2><p>　　下面举一个完整的例子。</p>
<p>　　对归并排序使用多线程进行求解，排序数据量不少于1M。</p>
<h3 id="1-程序结构"><a href="#1-程序结构" class="headerlink" title="　　1. 程序结构"></a>　　1. 程序结构</h3><p><img src="/photo/index/1018770-20180326230951282-1717138315.png" alt></p>
<h3 id="2-MakeArrays-java"><a href="#2-MakeArrays-java" class="headerlink" title="　　2. MakeArrays.java"></a>　　2. MakeArrays.java</h3><p>　　该类用于创建一个1M的随机测试数组，用于保证样本的统一性（串行与并行使用同一个数组）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> 1 import java.util.Random;</span><br><span class="line"> 2 </span><br><span class="line"> 3 public class MakeArrays &#123;</span><br><span class="line"> 4 </span><br><span class="line"> 5     private int length = 1024*1024;</span><br><span class="line"> 6     </span><br><span class="line"> 7     public int[] makeArray() &#123;</span><br><span class="line"> 8         int[] array = new int[length];</span><br><span class="line"> 9         </span><br><span class="line">10         Random random = new Random();</span><br><span class="line">11         for(int i=0; i&lt;length; i++) &#123;</span><br><span class="line">12             int x = random.nextInt();</span><br><span class="line">13             array[i] = x;</span><br><span class="line">14         &#125;</span><br><span class="line">15         </span><br><span class="line">16         return array;</span><br><span class="line">17     &#125;</span><br><span class="line">18     </span><br><span class="line">19 &#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-MergeSort-java"><a href="#3-MergeSort-java" class="headerlink" title="　　3. MergeSort.java"></a>　　3. MergeSort.java</h3><p>　　此部分用来编写归并排序算法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"> 1 public class MergeSort &#123;</span><br><span class="line"> 2 </span><br><span class="line"> 3     public static void sort(int[] array)&#123;</span><br><span class="line"> 4         int length = array.length;</span><br><span class="line"> 5         int[] tmpArray = new int[ length ];</span><br><span class="line"> 6         sort(array, tmpArray, 0, length-1);</span><br><span class="line"> 7     &#125;</span><br><span class="line"> 8 </span><br><span class="line"> 9     public static void sort(int[] array, int[] tmpArray, int left, int right)&#123;</span><br><span class="line">10         if(left &lt; right)&#123;</span><br><span class="line">11             int center = (left + right)/2;    //取中间值</span><br><span class="line">12             sort(array, tmpArray, left, center);    //递归分解</span><br><span class="line">13             sort(array, tmpArray, center+1, right);    //递归分解</span><br><span class="line">14             merge(array, tmpArray, left, center+1, right);    //合并排序</span><br><span class="line">15         &#125;</span><br><span class="line">16     &#125;</span><br><span class="line">17 </span><br><span class="line">18     private static void merge(int[] array, int[] tmpArray, int leftStart, int rightStart, int rightEnd) &#123;</span><br><span class="line">19         int leftEnd = rightStart - 1;    //左侧数组截止下标</span><br><span class="line">20         int tmpPos = leftStart;    //数组坐标</span><br><span class="line">21         int total = rightEnd - leftStart + 1;    //需要合并的数组元素数量</span><br><span class="line">22 </span><br><span class="line">23         while(leftStart &lt;= leftEnd &amp;&amp; rightStart &lt;= rightEnd)&#123;</span><br><span class="line">24             if(array[ leftStart ] &lt;= array[ rightStart ])&#123;</span><br><span class="line">25                 //如果左侧数组元素小于或等于右侧数组元素，将左侧数组元素的值存入临时数组，并移动左侧数组下标</span><br><span class="line">26                 tmpArray[ tmpPos++ ] = array[ leftStart++ ];</span><br><span class="line">27             &#125;else&#123;</span><br><span class="line">28                 //如果左侧数组元素大于右侧数组元素，将右侧数组元素的值存入临时数组，并移动右侧数组下标</span><br><span class="line">29                 tmpArray[ tmpPos++ ] = array[ rightStart++ ];</span><br><span class="line">30             &#125;</span><br><span class="line">31         &#125;</span><br><span class="line">32 </span><br><span class="line">33         //如果左侧数组元素没有全部存入临时数组，将剩余元素循环写入临时数组</span><br><span class="line">34         while(leftStart &lt;= leftEnd)&#123;</span><br><span class="line">35             tmpArray[ tmpPos++ ] = array[ leftStart++ ];</span><br><span class="line">36         &#125;</span><br><span class="line">37 </span><br><span class="line">38         //如果右侧数组元素没有全部存入临时数组，将剩余元素循环写入临时数组</span><br><span class="line">39         while(rightStart &lt;= rightEnd)&#123;</span><br><span class="line">40             tmpArray[ tmpPos++ ] = array[ rightStart++ ];</span><br><span class="line">41         &#125;</span><br><span class="line">42 </span><br><span class="line">43         //将临时数组中排序好的元素写入原数组</span><br><span class="line">44         for(int i = 0; i &lt; total; i++, rightEnd-- )&#123;</span><br><span class="line">45             array[ rightEnd ] = tmpArray[ rightEnd ];</span><br><span class="line">46         &#125;</span><br><span class="line">47 </span><br><span class="line">48     &#125;</span><br><span class="line">49 </span><br><span class="line">50 &#125;</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);" target="_blank" rel="noopener"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></p>
<h3 id="4-SerialDemo-java"><a href="#4-SerialDemo-java" class="headerlink" title="　　4. SerialDemo.java"></a>　　4. SerialDemo.java</h3><p>　　该类为串行代码，即不使用线程的情况下直接调用归并排序算法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1 public class SerialDemo2_5 &#123;</span><br><span class="line">2 </span><br><span class="line">3     public void mergeSort(int[] array) &#123;</span><br><span class="line">4         //归并排序</span><br><span class="line">5         MergeSort.sort(array);</span><br><span class="line">6     &#125;</span><br><span class="line">7     </span><br><span class="line">8 &#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-ThreadDemo-java"><a href="#5-ThreadDemo-java" class="headerlink" title="　　5. ThreadDemo.java"></a>　　5. ThreadDemo.java</h3><p>　　该类为并行代码，即使用多线程的情况下调用归并排序算法，这里以两个线程为例，将前面的1M的数组平均分为两份，分别交给这两个线程进行归并排序处理，然后再对其合并排序，得到最终的数组。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"> 1 import java.util.concurrent.CountDownLatch;</span><br><span class="line"> 2 </span><br><span class="line"> 3 public class ThreadDemo2_5 &#123;</span><br><span class="line"> 4 </span><br><span class="line"> 5     public void mergeSort(int[] array) throws InterruptedException &#123;</span><br><span class="line"> 6         int length = array.length;</span><br><span class="line"> 7         </span><br><span class="line"> 8         int minLength = length/2;</span><br><span class="line"> 9         int[] a = new int[minLength];</span><br><span class="line">10         int[] b = new int[minLength];</span><br><span class="line">11 </span><br><span class="line">12         for(int i=0; i&lt;2; i++)&#123;</span><br><span class="line">13             int start = minLength * i;</span><br><span class="line">14             int end = minLength * (i + 1);</span><br><span class="line">15 </span><br><span class="line">16             if(i==0)&#123;</span><br><span class="line">17                 for(int j=start, k=0; j&lt;end; j++,k++)&#123;</span><br><span class="line">18                     a[k] = array[j];</span><br><span class="line">19                 &#125;</span><br><span class="line">20             &#125;else if(i==1)&#123;</span><br><span class="line">21                 for(int j=start, k=0; j&lt;end; j++,k++)&#123;</span><br><span class="line">22                     b[k] = array[j];</span><br><span class="line">23                 &#125;</span><br><span class="line">24             &#125;</span><br><span class="line">25         &#125;</span><br><span class="line">26 </span><br><span class="line">27         //使用CountDownLatch来确保两个子线程都处理完毕后才执行最后的归并操作</span><br><span class="line">28         CountDownLatch latch = new CountDownLatch(2);</span><br><span class="line">29         new Thread(new Runnable()&#123;</span><br><span class="line">30 </span><br><span class="line">31             @Override</span><br><span class="line">32             public void run() &#123;</span><br><span class="line">33                 MergeSort.sort(a);</span><br><span class="line">34                 latch.countDown();</span><br><span class="line">35             &#125;</span><br><span class="line">36 </span><br><span class="line">37         &#125;).start();</span><br><span class="line">38 </span><br><span class="line">39         new Thread(new Runnable()&#123;</span><br><span class="line">40             @Override</span><br><span class="line">41             public void run() &#123;</span><br><span class="line">42                 MergeSort.sort(b);</span><br><span class="line">43                 latch.countDown();</span><br><span class="line">44             &#125;</span><br><span class="line">45         &#125;).start();</span><br><span class="line">46 </span><br><span class="line">47         //等待</span><br><span class="line">48         latch.await();</span><br><span class="line">49 </span><br><span class="line">50         //合并两个有序序列</span><br><span class="line">51         merge(a, b, array);</span><br><span class="line">52         </span><br><span class="line">53     &#125;</span><br><span class="line">54 </span><br><span class="line">55     //合并序列</span><br><span class="line">56     private static void merge(int[] a1, int[] a2, int[] tmpArray)&#123;</span><br><span class="line">57         int length1 = a1.length;</span><br><span class="line">58         int length2 = a2.length;</span><br><span class="line">59 </span><br><span class="line">60         int left = 0;</span><br><span class="line">61         int right = 0;</span><br><span class="line">62         int pos = 0;</span><br><span class="line">63 </span><br><span class="line">64         while(left &lt; length1 &amp;&amp; right &lt; length2)&#123;</span><br><span class="line">65             if(a1[left] &lt;= a2[right])&#123;</span><br><span class="line">66                 tmpArray[pos] = a1[left];</span><br><span class="line">67                 left++;</span><br><span class="line">68             &#125;else&#123;</span><br><span class="line">69                 tmpArray[pos] = a2[right];</span><br><span class="line">70                 right++;</span><br><span class="line">71             &#125;</span><br><span class="line">72             pos++;</span><br><span class="line">73         &#125;</span><br><span class="line">74 </span><br><span class="line">75         while(left &lt; length1)&#123;</span><br><span class="line">76             tmpArray[ pos++ ] = a1[ left++ ];</span><br><span class="line">77         &#125;</span><br><span class="line">78 </span><br><span class="line">79         while(right &lt; length2)&#123;</span><br><span class="line">80             tmpArray[ pos++ ] = a2[ right++ ];</span><br><span class="line">81         &#125;</span><br><span class="line">82 </span><br><span class="line">83     &#125;</span><br><span class="line">84     </span><br><span class="line">85 &#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-Main-java"><a href="#6-Main-java" class="headerlink" title="　　6. Main.java"></a>　　6. Main.java</h3><p>　　这里为主函数用于测试串行与并行的时间有何差别。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> 1 public class MainEx2_5 &#123;</span><br><span class="line"> 2     </span><br><span class="line"> 3     private static int[] array = new MakeArrays().makeArray();</span><br><span class="line"> 4     </span><br><span class="line"> 5     /**</span><br><span class="line"> 6      * 测试函数</span><br><span class="line"> 7      * @param args</span><br><span class="line"> 8      * ms : currentTimeMillis</span><br><span class="line"> 9      * ns : nanoTime</span><br><span class="line">10      */</span><br><span class="line">11     public static void main(String[] args) &#123;</span><br><span class="line">12         /**</span><br><span class="line">13          * 串行测试</span><br><span class="line">14          */</span><br><span class="line">15         long startTime = System.currentTimeMillis();   //获取开始时间</span><br><span class="line">16         new SerialDemo2_5().mergeSort(array);  //测试的代码段</span><br><span class="line">17         long endTime = System.currentTimeMillis(); //获取结束时间</span><br><span class="line">18         System.out.println(&quot;串行使用的时间： &quot;+(endTime-startTime)+&quot;ms&quot;);</span><br><span class="line">19         </span><br><span class="line">20         /**</span><br><span class="line">21          * 线程测试</span><br><span class="line">22          */</span><br><span class="line">23         long startTime1 = System.currentTimeMillis();   //获取开始时间</span><br><span class="line">24         try &#123;</span><br><span class="line">25             new ThreadDemo2_5().mergeSort(array);</span><br><span class="line">26         &#125; catch (InterruptedException e) &#123;</span><br><span class="line">27             // TODO Auto-generated catch block</span><br><span class="line">28             e.printStackTrace();</span><br><span class="line">29         &#125;  //测试的代码段</span><br><span class="line">30         long endTime1 = System.currentTimeMillis(); //获取结束时间</span><br><span class="line">31         System.out.println(&quot;线程使用的时间： &quot;+(endTime1-startTime1)+&quot;ms&quot;);</span><br><span class="line">32     &#125;</span><br><span class="line">33 </span><br><span class="line">34 &#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-运行结果"><a href="#7-运行结果" class="headerlink" title="　　7. 运行结果"></a>　　7. 运行结果</h3><p><img src="/photo/index/1018770-20180326231806593-867405148.png" alt></p>
<p>　　从这里可以看出并行的时间比线程少了很多，提高了效率。</p>
<p>　　这里再给另一种简单的代码，换了一种方法，可以自行理解。如下对随机产生的1M-10M的数组进行求和，这里只给出线程部分的代码（这个代码可以实现线程数自定）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"> 1 public class ThreadDemo1_1 &#123;</span><br><span class="line"> 2 </span><br><span class="line"> 3     /**</span><br><span class="line"> 4      * 对数组求和</span><br><span class="line"> 5      * @param array 数组</span><br><span class="line"> 6      * @param threadCount 线程数</span><br><span class="line"> 7      * @return 数组元素和</span><br><span class="line"> 8      */</span><br><span class="line"> 9     public long sumArray(final int[] array, int threadCount) &#123;</span><br><span class="line">10         if (array == null || array.length == 0) &#123;</span><br><span class="line">11             throw new IllegalArgumentException(&quot;数组长度必须大于0&quot;);</span><br><span class="line">12         &#125;</span><br><span class="line">13 </span><br><span class="line">14         final RuntimeSave rd = new RuntimeSave();     // 保存数据</span><br><span class="line">15         final int lenPerThread = array.length / threadCount;  // 计算每个线程的数组元素个数</span><br><span class="line">16         </span><br><span class="line">17         for (int i = 0; i &lt; threadCount; i++) &#123;</span><br><span class="line">18             final int index = i;</span><br><span class="line">19             new Thread() &#123;</span><br><span class="line">20                 @Override</span><br><span class="line">21                 public void run() &#123;</span><br><span class="line">22                     long s = 0;</span><br><span class="line">23                     int start = index * lenPerThread;</span><br><span class="line">24                     int end = start + lenPerThread;</span><br><span class="line">25                     </span><br><span class="line">26                     for (int j = start; j &lt; end; j++) &#123;</span><br><span class="line">27                         s += array[j];</span><br><span class="line">28                     &#125;</span><br><span class="line">29                     synchronized (rd) &#123;</span><br><span class="line">30                         rd.sum += s;</span><br><span class="line">31                         rd.finishThreadCount++;</span><br><span class="line">32                     &#125;</span><br><span class="line">33                 &#125;;</span><br><span class="line">34             &#125;.start();</span><br><span class="line">35         &#125;</span><br><span class="line">36    </span><br><span class="line">37         int remain = array.length % threadCount;      // 剩余数组元素</span><br><span class="line">38         long s = 0;</span><br><span class="line">39         </span><br><span class="line">40         for (int i = array.length - remain; i &lt; array.length; i++) &#123;</span><br><span class="line">41             s += array[i];  </span><br><span class="line">42         &#125;</span><br><span class="line">43         synchronized (rd) &#123;  </span><br><span class="line">44             rd.sum += s;</span><br><span class="line">45         &#125;</span><br><span class="line">46         </span><br><span class="line">47         while (rd.finishThreadCount != threadCount) &#123;</span><br><span class="line">48             try &#123;</span><br><span class="line">49                 Thread.sleep(1);</span><br><span class="line">50             &#125; catch (InterruptedException e) &#123;</span><br><span class="line">51                 e.printStackTrace();</span><br><span class="line">52                 break;</span><br><span class="line">53             &#125;  </span><br><span class="line">54         &#125;  </span><br><span class="line">55         return rd.sum;</span><br><span class="line">56     &#125;</span><br><span class="line">57     </span><br><span class="line">58     /**</span><br><span class="line">59      * 保存运行时的相关数据</span><br><span class="line">60      * @author adamjwh</span><br><span class="line">61      *</span><br><span class="line">62      */</span><br><span class="line">63     static class RuntimeSave &#123;</span><br><span class="line">64         long sum;  // 保存求和</span><br><span class="line">65         int finishThreadCount;  // 已执行完毕的线程数</span><br><span class="line">66     &#125;</span><br><span class="line">67 &#125;</span><br></pre></td></tr></table></figure>
    </div>
</article>


<div id="comments-template"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script>
	if(!window.commentConfig) {
      window.commentConfig = {}
      window.commentConfig.title = 'Java高级篇（一）——线程'
    }
</script>

                </div>
                <aside class="col-md-4 gal-left" id="sidebar">
    <!-- 此为sidebar的搜索框, 非搜索结果页面 -->
<aside id="sidebar-search">
    <div class="search hidden-xs" data-aos="fade-up" data-aos-duration="2000">
        <form class="form-inline clearfix" id="search-form" method="get"
              action="/search/index.html">
            <input type="text" name="s" class="form-control" id="searchInput" placeholder="搜索文章~" autocomplete="off">
            <button class="btn btn-danger btn-gal" type="submit">
                <i class="fa fa-search"></i>
            </button>
        </form>
    </div>
</aside>
    <aside id="sidebar-author">
    <div class="panel panel-gal" data-aos="flip-right" data-aos-duration="3000">
        <div class="panel-heading" style="text-align: center">
            <i class="fa fa-quote-left"></i>
            Armani
            <i class="fa fa-quote-right"></i>
        </div>
        <div class="author-panel text-center">
            <img src="/imgs/avatar.jpg" width="140" height="140"
                 alt="个人头像" class="author-image">
            <p class="author-description">가죽 돼지</p>
        </div>
    </div>
</aside>
    
    <aside id="sidebar-recent_comments">
    <div class="panel panel-gal recent hidden-xs" data-aos="fade-up" data-aos-duration="2000">
        <div class="panel-heading">
            <i class="fa fa-comments"></i>
            最新评论
            <i class="fa fa-times-circle panel-remove"></i>
            <i class="fa fa-chevron-circle-up panel-toggle"></i>
        </div>
        <ul class="list-group list-group-flush"></ul>
    </div>
</aside>
    
    <!-- 要配置好leancloud才能开启此小工具 -->
    
    <aside id="sidebar-hot_posts">
    <div class="panel panel-gal hot hidden-xs" data-aos="fade-up" data-aos-duration="2000">
        <div class="panel-heading">
            <i class="fa fa-fire"></i>
            最热文章
            <i class="fa fa-times-circle panel-remove"></i>
            <i class="fa fa-chevron-circle-up panel-toggle"></i>
        </div>
        <ul class="list-group list-group-flush"></ul>
    </div>
</aside>
    
    
    <aside id="sidebar-recent_posts">
    <div class="panel panel-gal recent hidden-xs" data-aos="fade-up" data-aos-duration="2000">
        <div class="panel-heading">
            <i class="fa fa-refresh"></i>
            近期文章
            <i class="fa fa-times-circle panel-remove"></i>
            <i class="fa fa-chevron-circle-up panel-toggle"></i>
        </div>
        <ul class="list-group list-group-flush">
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/30/回首过往/">回首过往</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/28/资源分享/">资源分享</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/28/我就是我/">我就是我</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/27/Jekyll建立Github博客/">Jekyll建立Github博客</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/26/支付宝诞生的故事  /">支付宝诞生的故事</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/26/腾讯视频如何转换MP4格式的2种方法/">腾讯视频如何转换MP4格式的2种方法</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/26/关于第三方支付，看这篇文章就够了！/">关于第三方支付，看这篇文章就够了！</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/26/JAVA 排序之选择排序、堆排序/">JAVA 排序之选择排序、堆排序</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/26/Java 排序之插入排序、希尔排序/">Java 排序之插入排序、希尔排序</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/26/为什么说-Java-程序员到了必须掌握-Spring-Boot-的时候？/">为什么说 Java 程序员到了必须掌握 Spring Boot 的时候？</a>
                </span>
            </li>
            
        </ul>
    </div>
</aside>
    
    
    <aside id="sidebar-rand_posts">
    <div class="panel panel-gal recent hidden-xs" data-aos="fade-up" data-aos-duration="2000">
        <div class="panel-heading">
            <i class="fa fa-refresh"></i>
            随机文章
            <i class="fa fa-times-circle panel-remove"></i>
            <i class="fa fa-chevron-circle-up panel-toggle"></i>
        </div>
        <ul class="list-group list-group-flush">
            
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/22/MikuTools全能网站/">MikuTools全能网站</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/14/hexo教程搜索SEO+阅读量统计+访问量统计+评论系统/">hexo教程搜索SEO+阅读量统计+访问量统计+评论系统</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/20/你要安静的努力，然后悄无声息的变强/">你要安静的努力，然后悄无声息的变强</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/15/长大后才明白的真相/">长大后才明白的真相</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/15/Java进阶篇（六）——Swing程序设计（上）/">Java进阶篇（六）——Swing程序设计（上）</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/24/SpringBoot (四) ：thymeleaf 使用详解/">SpringBoot (四) ：thymeleaf 使用详解</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/26/支付宝诞生的故事  /">支付宝诞生的故事</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/23/轻松装Win10：VMware-Workstation-12虚拟机下载/">轻松装Win10：VMware Workstation 12虚拟机下载</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/15/Vue-js框架/">Vue.js框架</a>
                </span>
            </li>
            
            <li class="list-group-item">
                <span class="post-title">
                    <a href="/2019/08/19/创意网站介绍/">创意网站介绍</a>
                </span>
            </li>
            
        </ul>
    </div>
</aside>
    
    
    <aside id="gal-sets">
        <div class="panel panel-gal hidden-xs" data-aos="fade-up" data-aos-duration="2000">
            <ul class="nav nav-pills pills-gal">

                
                <li>
                    <a href="/2019/08/15/Java高级篇（一）——线程/index.html#sidebar-tags" data-toggle="tab" id="tags-tab">热门标签</a>
                </li>
                
                
                <li>
                    <a href="/2019/08/15/Java高级篇（一）——线程/index.html#sidebar-friend-links" data-toggle="tab" id="friend-links-tab">友情链接</a>
                </li>
                
                
                <li>
                    <a href="/2019/08/15/Java高级篇（一）——线程/index.html#sidebar-links" data-toggle="tab" id="links-tab">个人链接</a>
                </li>
                
            </ul>
            <div class="tab-content">
                
                <div class="cloud-tags tab-pane nav bs-sidenav fade" id="sidebar-tags">
    
    <a href="/tags/hexo/" style="font-size: 9.36922644671424px;" class="tag-cloud-link">hexo</a>
    
    <a href="/tags/3-hexo/" style="font-size: 19.58076895827355px;" class="tag-cloud-link">3-hexo</a>
    
    <a href="/tags/Apache/" style="font-size: 19.296314019045063px;" class="tag-cloud-link">Apache</a>
    
    <a href="/tags/Tomcat/" style="font-size: 9.03235982993007px;" class="tag-cloud-link">Tomcat</a>
    
    <a href="/tags/服务器/" style="font-size: 10.04280905783472px;" class="tag-cloud-link">服务器</a>
    
    <a href="/tags/css/" style="font-size: 14.776499519341417px;" class="tag-cloud-link">css</a>
    
    <a href="/tags/Flex/" style="font-size: 11.224787883344167px;" class="tag-cloud-link">Flex</a>
    
    <a href="/tags/HTML/" style="font-size: 8.95413417162489px;" class="tag-cloud-link">HTML</a>
    
    <a href="/tags/JavaScript/" style="font-size: 11.269071320770404px;" class="tag-cloud-link">JavaScript</a>
    
    <a href="/tags/HTML5/" style="font-size: 19.4089881245382px;" class="tag-cloud-link">HTML5</a>
    
    <a href="/tags/idea/" style="font-size: 16.958770963930554px;" class="tag-cloud-link">idea</a>
    
    <a href="/tags/IDEA/" style="font-size: 17.601521511700312px;" class="tag-cloud-link">IDEA</a>
    
    <a href="/tags/Java/" style="font-size: 19.856771690963676px;" class="tag-cloud-link">Java</a>
    
    <a href="/tags/js/" style="font-size: 17.744617893720125px;" class="tag-cloud-link">js</a>
    
    <a href="/tags/JDBC/" style="font-size: 18.590419878161388px;" class="tag-cloud-link">JDBC</a>
    
    <a href="/tags/MySQL/" style="font-size: 16.875838256518666px;" class="tag-cloud-link">MySQL</a>
    
    <a href="/tags/Github/" style="font-size: 13.06918248650593px;" class="tag-cloud-link">Github</a>
    
    <a href="/tags/node-js/" style="font-size: 8.964237260930656px;" class="tag-cloud-link">node.js</a>
    
    <a href="/tags/Node-js/" style="font-size: 18.65619017166176px;" class="tag-cloud-link">Node.js</a>
    
    <a href="/tags/PHP/" style="font-size: 12.026202773152907px;" class="tag-cloud-link">PHP</a>
    
    <a href="/tags/PanDownload/" style="font-size: 15.570746233640048px;" class="tag-cloud-link">PanDownload</a>
    
    <a href="/tags/Python/" style="font-size: 11.783355255608392px;" class="tag-cloud-link">Python</a>
    
    <a href="/tags/java/" style="font-size: 19.582129137057986px;" class="tag-cloud-link">java</a>
    
    <a href="/tags/SpringBoot/" style="font-size: 12.922582054036642px;" class="tag-cloud-link">SpringBoot</a>
    
    <a href="/tags/Vue/" style="font-size: 14.947122897799px;" class="tag-cloud-link">Vue</a>
    
    <a href="/tags/框架/" style="font-size: 13.187942068372848px;" class="tag-cloud-link">框架</a>
    
    <a href="/tags/nodejs/" style="font-size: 12.690066860671681px;" class="tag-cloud-link">nodejs</a>
    
    <a href="/tags/GitHub/" style="font-size: 8.98465666323691px;" class="tag-cloud-link">GitHub</a>
    
    <a href="/tags/gitbash/" style="font-size: 10.10104298873359px;" class="tag-cloud-link">gitbash</a>
    
    <a href="/tags/final/" style="font-size: 8.516356024950456px;" class="tag-cloud-link">final</a>
    
    <a href="/tags/常量/" style="font-size: 18.933237696855425px;" class="tag-cloud-link">常量</a>
    
    <a href="/tags/数据库/" style="font-size: 11.234298351907444px;" class="tag-cloud-link">数据库</a>
    
    <a href="/tags/Markdown/" style="font-size: 13.85513194123483px;" class="tag-cloud-link">Markdown</a>
    
    <a href="/tags/Typora/" style="font-size: 16.817985281268864px;" class="tag-cloud-link">Typora</a>
    
    <a href="/tags/mysql/" style="font-size: 15.839897583957033px;" class="tag-cloud-link">mysql</a>
    
    <a href="/tags/npm/" style="font-size: 10.775753648984534px;" class="tag-cloud-link">npm</a>
    
    <a href="/tags/安卓/" style="font-size: 9.336337315777293px;" class="tag-cloud-link">安卓</a>
    
    <a href="/tags/博客/" style="font-size: 15.8130348498102px;" class="tag-cloud-link">博客</a>
    
    <a href="/tags/reading/" style="font-size: 11.59864386768331px;" class="tag-cloud-link">reading</a>
    
    <a href="/tags/数据结构/" style="font-size: 11.041881821890737px;" class="tag-cloud-link">数据结构</a>
    
    <a href="/tags/Chrome/" style="font-size: 12.590492060900036px;" class="tag-cloud-link">Chrome</a>
    
    <a href="/tags/Cookie/" style="font-size: 18.49605210602441px;" class="tag-cloud-link">Cookie</a>
    
    <a href="/tags/Session/" style="font-size: 8.344805404434247px;" class="tag-cloud-link">Session</a>
    
    <a href="/tags/剪辑/" style="font-size: 18.20521922500818px;" class="tag-cloud-link">剪辑</a>
    
    <a href="/tags/缘起/" style="font-size: 17.330828610576326px;" class="tag-cloud-link">缘起</a>
    
    <a href="/tags/虚拟机/" style="font-size: 18.870793012561972px;" class="tag-cloud-link">虚拟机</a>
    
    <a href="/tags/模拟器/" style="font-size: 19.152325098657425px;" class="tag-cloud-link">模拟器</a>
    
    <a href="/tags/引导页/" style="font-size: 13.025621987274867px;" class="tag-cloud-link">引导页</a>
    
    <a href="/tags/智慧树/" style="font-size: 11.811456120749678px;" class="tag-cloud-link">智慧树</a>
    
    <a href="/tags/测试/" style="font-size: 14.762700243383428px;" class="tag-cloud-link">测试</a>
    
    <a href="/tags/物语/" style="font-size: 15.018943748677758px;" class="tag-cloud-link">物语</a>
    
    <a href="/tags/图床/" style="font-size: 14.080351105297483px;" class="tag-cloud-link">图床</a>
    
    <a href="/tags/CSS/" style="font-size: 15.289294692814511px;" class="tag-cloud-link">CSS</a>
    
    <a href="/tags/轮播图/" style="font-size: 12.638548988656723px;" class="tag-cloud-link">轮播图</a>
    
    <a href="/tags/鼠标点击/" style="font-size: 16.367491941107144px;" class="tag-cloud-link">鼠标点击</a>
    
    <a href="/tags/点击特效/" style="font-size: 8.473156338744992px;" class="tag-cloud-link">点击特效</a>
    
    <a href="/tags/前端/" style="font-size: 15.97915152764848px;" class="tag-cloud-link">前端</a>
    
    <a href="/tags/Hexo/" style="font-size: 8.194382957535963px;" class="tag-cloud-link">Hexo</a>
    
    <a href="/tags/Swing/" style="font-size: 16.817850972154748px;" class="tag-cloud-link">Swing</a>
    
    <a href="/tags/Android/" style="font-size: 8.741767621439742px;" class="tag-cloud-link">Android</a>
    
    <a href="/tags/Vue-js/" style="font-size: 9.98731522984331px;" class="tag-cloud-link">Vue.js</a>
    
    <a href="/tags/Spring-Boot/" style="font-size: 8.359892114559347px;" class="tag-cloud-link">Spring Boot</a>
    
    <a href="/tags/网页设计/" style="font-size: 15.178537400887294px;" class="tag-cloud-link">网页设计</a>
    
    <a href="/tags/HTMK/" style="font-size: 8.160193616647593px;" class="tag-cloud-link">HTMK</a>
    
    <a href="/tags/JS/" style="font-size: 8.235402668038564px;" class="tag-cloud-link">JS</a>
    
</div>
                
                
                <div class="friend-links tab-pane nav bs-sidenav fade" id="sidebar-friend-links">
    
    <li>
        <a href="http://kdays.net/days/" target="_blank">KDays Forum</a>
    </li>
    
    <li>
        <a href="http://www.gal123.com/" target="_blank">绅士导航♂</a>
    </li>
    
    <li>
        <a href="http://www.moe123.com/" target="_blank">萌导航</a>
    </li>
    
</div>
                
                
                <div class="links tab-pane nav bs-sidenav fade" id="sidebar-links">
    
    <li>
        <a href="https://github.com/ZEROKISEKI/" target="_blank">Github</a>
    </li>
    
    <li>
        <a href="https://coding.net/u/SORA1" target="_blank">Coding</a>
    </li>
    
    <li>
        <a href="https://www.zhihu.com/people/aonosora/activities" target="_blank">知乎</a>
    </li>
    
</div>
                
            </div>
        </div>
    </aside>
    
</aside>
            </div>
        </div>
    </div>
    <footer id="gal-footer">
    <div class="container">
        Copyright © 2019 Armani Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>.&nbsp;Theme by <a href="https://github.com/ZEROKISEKI" target="_blank">AONOSORA</a>
    </div>
	<span id="sitetime"></span>
<script language=javascript>
    function siteTime(){
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth()+1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数 */
        var t1 = Date.UTC(2019,08,24,00,00,00); //北京时间2018-2-13 00:00:00
        var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
        var diff = t2-t1;
        var diffYears = Math.floor(diff/years);
        var diffDays = Math.floor((diff/days)-diffYears*365);
        var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
        var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
        var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
        document.getElementById("sitetime").innerHTML="本网站已运行"+diffYears+" 年 "+diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
</script>
<p>本站访问人数：***人 | ◎本站总访问量：***人次</p>
</footer>



<!-- 回到顶端 -->
<div id="gal-gotop">
    <i class="fa fa-angle-up"></i>
</div>

<!--给WordPress网站添加鼠标点击爆炸五颜六色特效-->
    <canvas class="fireworks" style="position:fixed;left:0;top:0;z-index:99999999;pointer-events:none;"></canvas>
<script type="text/javascript" src="http://a-oss.zmki.cn/20190502/aixintexiao.js"></script>


</body>
<script src="/js/activate-power-mode.js"></script>
<script>

    // 配置highslide
	hs.graphicsDir = '/js/highslide/graphics/'
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.lang.number = '共%2张图, 当前是第%1张';
    hs.addSlideshow({
      interval: 5000,
      repeat: true,
      useControls: true,
      fixedControls: "fit",
      overlayOptions: {
        opacity: 0.75,
        position: "bottom center",
        hideOnMouseOut: true
      }
    })

    // 初始化aos
    AOS.init({
      duration: 1000,
      delay: 0,
      easing: 'ease-out-back'
    });

</script>
<script>
	POWERMODE.colorful = 'true';    // make power mode colorful
	POWERMODE.shake = 'true';       // turn off shake
	// TODO 这里根据具体情况修改
	document.body.addEventListener('input', POWERMODE);
</script>
<script>
    window.slideConfig = {
      prefix: '/imgs/slide/background',
      ext: 'jpg',
      maxCount: '6'
    }
</script>
<script src="/js/hs.js"></script>
<script src="/js/blog.js"></script>

<script src="/js/oni.js"></script>


<script>
    window.hot_posts_count = '10'
    // window.use_leancloud = 'true'
</script>
<script src="/js/comment/leancloud.js"></script>


<script src="https://myau.moe/js/comment/gitment.browser.js"></script>
<script>
    if(window.commentConfig) {
      window.commentConfig.id = 'Thu Aug 15 2019 12:37:05 GMT+0800'
      window.commentConfig.owner = 'Armani6'
      window.commentConfig.repo = 'Armani6.github.io'
      window.commentConfig.client_id = '0f5c2c94c19aebf669ba'
      window.commentConfig.client_secret = '7895f37559318fb26f59f6a5f2400224e9bc0950'
      window.commentConfig.redirect_uri = 'https://z.zhsh666.xyz'
    } else {
      window.commentConfig = {
      	id: 'Thu Aug 15 2019 12:37:05 GMT+0800',
        owner: 'Armani6',
        repo: 'Armani6.github.io',
        client_id: '0f5c2c94c19aebf669ba',
        client_secret: '7895f37559318fb26f59f6a5f2400224e9bc0950',
        redirect_uri: 'https://z.zhsh666.xyz'
      }
    }
</script>
<script src="/js/comment/gitment.js"></script>

</html>